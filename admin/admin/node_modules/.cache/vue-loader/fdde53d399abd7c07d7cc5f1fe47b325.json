{"remainingRequest":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\src\\views\\orderdetail\\refund.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\src\\views\\orderdetail\\refund.vue","mtime":1670030632847},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666323412932},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\babel-loader\\lib\\index.js","mtime":1666323415343},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666323412932},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":1666323415965}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBtb3VudGVkKCkgewogICAgICAgIHRoaXMub3JkZXJkYXRhKCk7CgogICAgfSwKCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHRvdGFsOiAwLAogICAgICAgICAgICBwYWdlc2l6ZTogNSwKICAgICAgICAgICAgY3VycmVudFBhZ2U6IDEsCiAgICAgICAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgICAgICAgIGl0ZW06e30sLy/opoHotK3kubDnmoTllYblk4EKICAgICAgICAgICAgb3JkZXI6e30sLy/liJvlu7rnmoTorqLljZUKICAgICAgICAgICAgdXNlcjp7fSwKICAgICAgICAgICAgdWlkOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyZGF0YScpKS5pZCwKICAgICAgICB9OwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICAvLyDojrflj5bnrKzkuIDpobXooajmoLzmlbDmja4KICAgICAgICBhc3luYyBvcmRlcmRhdGEoKSB7CiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KAogICAgICAgICAgICAgICAgYC9tbnBheS9yZWZ1bmRsaXN0P2N1cnJlbnRQYWdlPSR7MX0mc2l6ZT0ke3RoaXMucGFnZXNpemV9YCx7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIgKyBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyZGF0YScpKS50b2tlbgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXN1bHQuZGF0YS5kYXRhOwogICAgICAgICAgICAgICAgdGhpcy50b3RhbCA9IE51bWJlcihyZXN1bHQuZGF0YS50b3RhbCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnRhYmxlRGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBhc3luYyBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgewogICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLiRodHRwLmdldCgKICAgICAgICAgICAgICAgIGAvbW5wYXkvcmVmdW5kbGlzdD9jdXJyZW50UGFnZT0ke3ZhbH0mc2l6ZT0ke3RoaXMucGFnZXNpemV9JmlkPWArdGhpcy51aWQsewogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiICsgSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcmRhdGEnKSkudG9rZW4KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmIChyZXN1bHQuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzdWx0LmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgIHRoaXMudG90YWwgPSBOdW1iZXIocmVzdWx0LmRhdGEudG90YWwpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgcmVmdW5kQ2xpY2socm93LHN0YXR1cykgewogICAgICAgICAgICB0aGlzLm9yZGVyPXJvdzsKICAgICAgICAgICAgdGhpcy5pdGVtLnByaWNlPXJvdy50b3RhbEZlZTsKICAgICAgICAgICAgdGhpcy5pdGVtLmlkPXJvdy5wcm9kdWN0SWQ7CiAgICAgICAgICAgIHRoaXMuaXRlbS5wb2ludD1yb3cucG9pbnQ7CgogICAgICAgICAgICBpZih0aGlzLm9yZGVyLnBheW1lbnRUeXBlPT0i5pSv5LuY5a6dIil7CiAgICAgICAgICAgICAgICBpZihzdGF0dXM9PSLlt7LpgIDmrL4iKXsvL+iwg+eUqOaUr+S7mOWuneeahOWQjOaEj+mAgOasvgoKCiAgICAgICAgICAgICAgICB9ZWxzZXsvL+iwg+eUqOaUr+S7mOWuneeahOaLkue7nemAgOasvgoKCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH1lbHNley8v5qih5ouf5pSv5LuY55qE6YCA5qy+CiAgICAgICAgICAgICAgICBpZihzdGF0dXM9PSLlt7LpgIDmrL4iKXsvL+WQjOaEj+mAgOasvgogICAgICAgICAgICAgICAgICAgIHRoaXMuJGNvbmZpcm0oIuaCqOehruWumuimgeWQjOaEj+mAgOasvuWQlz8iLCAi5o+Q56S6IiwgewogICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIuehruWumiIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAid2FybmluZyIsCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAudGhlbihhc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGh0dHAuZ2V0KCIvbW5wYXkvY2hlY2tyZWZ1bmQ/aWQ9Iit0aGlzLm9yZGVyLmlkKyImc3RhdHVzPSIrc3RhdHVzLHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIgKyBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyZGF0YScpKS50b2tlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKHJlc3A9PnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlc3Auc3RhdHVzPT09MjAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzcC5kYXRhLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwLmRhdGEubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9yZGVyZGF0YSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZm9yY2VVcGRhdGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIH1lbHNley8v5ouS57ud6YCA5qy+CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kY29uZmlybSgi5oKo56Gu5a6a6KaB5ouS57ud6YCA5qy+5ZCXPyIsICLmj5DnpLoiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogIuWPlua2iCIsCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kaHR0cC5nZXQoIi9tbnBheS9jaGVja3JlZnVuZD9pZD0iK3RoaXMub3JkZXIuaWQrIiZzdGF0dXM9IitzdGF0dXMsewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIiArIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJkYXRhJykpLnRva2VuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4ocmVzcD0+ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzcC5zdGF0dXM9PT0yMDApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXNwLmRhdGEubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3AuZGF0YS5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3JkZXJkYXRhKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRmb3JjZVVwZGF0ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgfSwKfTsK"},{"version":3,"sources":["refund.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"refund.vue","sourceRoot":"src/views/orderdetail","sourcesContent":["<!--用户列表-->\r\n<template>\r\n    <div>\r\n        <el-card class=\"box-card\">\r\n            <h3 class=\"title\">退款审核</h3>\r\n            <el-table\r\n                    :data=\"tableData\"\r\n                    border\r\n                    :row-style=\"{ height: '50px' }\"\r\n                    :cell-style=\"{ padding: '0px' }\"\r\n                    max-height=\"550\"\r\n                    style=\"width: 100%\"\r\n            >\r\n                <el-table-column prop=\"orderNo\" label=\"订单号\" width=\"220\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"username\" label=\"用户名\" width=\"100\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"title\" label=\"物品名称\" width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"totalFee\" label=\"现金\" width=\"75\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"point\" label=\"积分\" width=\"75\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"orderStatus\" label=\"订单状态\" width=\"90\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"paymentType\" label=\"支付方式\" width=\"90\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"createTime\" label=\"订单创建时间\" width=\"180\">\r\n                </el-table-column>\r\n                <el-table-column fixed=\"right\" label=\"操作\" width=\"230\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button @click='refundClick(scope.row,\"已退款\")' type=\"primary\" size=\"small\">审核通过</el-button>\r\n                        <el-button @click='refundClick(scope.row,\"退款异常\")' type=\"warning\" size=\"small\">审核不通过</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <!-- 分页 -->\r\n            <div class=\"block\" style=\"margin-top: 20px;\">\r\n                <el-pagination\r\n                        background\r\n                        @current-change=\"handleCurrentChange\"\r\n                        :current-page.sync=\"currentPage\"\r\n                        :page-size=\"pagesize\"\r\n                        layout=\"prev, pager, next, jumper\"\r\n                        :total=\"total\"\r\n                >\r\n                </el-pagination>\r\n            </div>\r\n\r\n\r\n        </el-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import axios from \"axios\";\r\n\r\n    export default {\r\n        mounted() {\r\n            this.orderdata();\r\n\r\n        },\r\n\r\n        data() {\r\n            return {\r\n                total: 0,\r\n                pagesize: 5,\r\n                currentPage: 1,\r\n                tableData: [],\r\n                item:{},//要购买的商品\r\n                order:{},//创建的订单\r\n                user:{},\r\n                uid: JSON.parse(localStorage.getItem('userdata')).id,\r\n            };\r\n        },\r\n        methods: {\r\n            // 获取第一页表格数据\r\n            async orderdata() {\r\n                const result = await this.$http.get(\r\n                    `/mnpay/refundlist?currentPage=${1}&size=${this.pagesize}`,{\r\n                        headers: {\r\n                            Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n                        }\r\n                    }\r\n                );\r\n                if (result.status === 200) {\r\n                    this.tableData = result.data.data;\r\n                    this.total = Number(result.data.total);\r\n                    console.log(this.tableData);\r\n                }\r\n            },\r\n\r\n            async handleCurrentChange(val) {\r\n                const result = await this.$http.get(\r\n                    `/mnpay/refundlist?currentPage=${val}&size=${this.pagesize}&id=`+this.uid,{\r\n                        headers: {\r\n                            Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n                        }\r\n                    }\r\n                );\r\n                if (result.status === 200) {\r\n                    this.tableData = result.data.data;\r\n                    this.total = Number(result.data.total);\r\n                }\r\n            },\r\n\r\n            refundClick(row,status) {\r\n                this.order=row;\r\n                this.item.price=row.totalFee;\r\n                this.item.id=row.productId;\r\n                this.item.point=row.point;\r\n\r\n                if(this.order.paymentType==\"支付宝\"){\r\n                    if(status==\"已退款\"){//调用支付宝的同意退款\r\n\r\n\r\n                    }else{//调用支付宝的拒绝退款\r\n\r\n\r\n                    }\r\n                }else{//模拟支付的退款\r\n                    if(status==\"已退款\"){//同意退款\r\n                        this.$confirm(\"您确定要同意退款吗?\", \"提示\", {\r\n                            confirmButtonText: \"确定\",\r\n                            cancelButtonText: \"取消\",\r\n                            type: \"warning\",\r\n                        })\r\n                        .then(async () => {\r\n                            this.$http.get(\"/mnpay/checkrefund?id=\"+this.order.id+\"&status=\"+status,{\r\n                                headers: {\r\n                                    Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n                                }\r\n                            }).then(resp=>{\r\n                                if(resp.status===200){\r\n                                    this.$message.success(resp.data.message);\r\n                                }else{\r\n                                    this.$message.error(resp.data.message);\r\n                                }\r\n                                this.orderdata();\r\n                                this.$forceUpdate();\r\n                            })\r\n                        })\r\n\r\n                    }else{//拒绝退款\r\n                        this.$confirm(\"您确定要拒绝退款吗?\", \"提示\", {\r\n                            confirmButtonText: \"确定\",\r\n                            cancelButtonText: \"取消\",\r\n                            type: \"warning\",\r\n                        })\r\n                        .then(async () => {\r\n                            this.$http.get(\"/mnpay/checkrefund?id=\"+this.order.id+\"&status=\"+status,{\r\n                                headers: {\r\n                                    Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n                                }\r\n                            }).then(resp=>{\r\n                                if(resp.status===200){\r\n                                    this.$message.success(resp.data.message);\r\n                                }else{\r\n                                    this.$message.error(resp.data.message);\r\n                                }\r\n                                this.orderdata();\r\n                                this.$forceUpdate();\r\n                            })\r\n                        })\r\n                    }\r\n                }\r\n            },\r\n        },\r\n    };\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    .carid {\r\n        display: none;\r\n    }\r\n    .demo-form-inline {\r\n        display: flex;\r\n        flex: left;\r\n    }\r\n    .el-form-item {\r\n        margin-bottom: 20px;\r\n    }\r\n    .avatar-uploader .el-upload {\r\n        border: 1px dashed #d9d9d9;\r\n        border-radius: 100px;\r\n        cursor: pointer;\r\n        position: relative;\r\n        overflow: hidden;\r\n    }\r\n    // .avatar-uploader .el-upload:hover {\r\n    // //   border-color: #409eff;\r\n    // }\r\n    .avatar-uploader-icon {\r\n        font-size: 28px;\r\n        color: #8c939d;\r\n        width: 178px;\r\n        height: 178px;\r\n        line-height: 178px;\r\n        text-align: center;\r\n    }\r\n    .avatar {\r\n        width: 250px;\r\n        /*display: block;*/\r\n        /*border-radius: 100px;*/\r\n    }\r\n</style>\r\n"]}]}