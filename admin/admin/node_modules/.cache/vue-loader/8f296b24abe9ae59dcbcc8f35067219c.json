{"remainingRequest":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\src\\components\\articledetail.vue?vue&type=style&index=0&id=104edd67&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\src\\components\\articledetail.vue","mtime":1670223004631},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\css-loader\\dist\\cjs.js","mtime":1666323413935},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1666323416977},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\postcss-loader\\src\\index.js","mtime":1666323415315},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\less-loader\\dist\\cjs.js","mtime":1666323414827},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666323412932},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":1666323415965}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCmltYWdlIHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMTAwJTsNCn0NCi8vIOivhOiuuueahOagt+W8jw0KLmNvbW1lbnQtdXNlcm5hbWUgew0KICBmb250LXNpemU6IDIwcHg7DQogIGhlaWdodDogMzBweDsNCiAgbGluZS1oZWlnaHQ6IDMwcHg7DQogIHBhZGRpbmctdG9wOiAxMHB4Ow0KICBtYXJnaW4tbGVmdDogMnZoOw0KfQ0KLnJlcGxheSB7DQogIG1hcmdpbi1sZWZ0OiAyMHB4Ow0KICBwYWRkaW5nLXRvcDogMTBweDsNCiAgY29sb3I6IHJlZDsNCn0NCi5jb21tZW50LWNvbnRlbnQgew0KICBtYXJnaW4tbGVmdDogOHZoOw0KICBmb250LXNpemU6IDE4cHg7DQp9DQoucmVjb21tZW50IHsNCiAgbWFyZ2luLXRvcDogNXB4Ow0KICBjb2xvcjogIzRjNDk0ODsNCn0NCg=="},{"version":3,"sources":["articledetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"articledetail.vue","sourceRoot":"src/components","sourcesContent":["<!--文章详情-->\r\n<template>\r\n  <div style=\"background-color: #efefef; text-align: left\">\r\n    <!-- 背景图片 -->\r\n    <div class=\"background-image\">\r\n      <!-- 文章内容 -->\r\n      <el-card\r\n        style=\"\r\n          width: 100%;\r\n          min-height: 400px;\r\n          height: auto !important;\r\n          margin-bottom: 20px;\r\n        \"\r\n      >\r\n        <el-page-header @back=\"goBack\" content=\"查看文章\"></el-page-header>\r\n        <!-- 文章内容 -->\r\n        <h1 style=\"text-align: center;font-family: 楷体\">{{myBlog.title}}</h1>\r\n        <p style=\"margin-left: 200px;font-weight:bold;font-size: 17px;\">作者：{{myBlog.author}}</p>\r\n        <div class=\"contentBox\" v-html=\"myBlog.content\" style=\"width:70%;margin-left:auto;margin-right:auto;\"></div>\r\n\r\n        <!-- 评论内容 -->\r\n        <el-card\r\n          style=\"\r\n            width: 80%;\r\n            min-height: 200px;\r\n            height: auto !important;\r\n            margin-left: 10%;\r\n            margin-top: 2vh;\r\n            margin-bottom: 20px;\r\n          \"\r\n        >\r\n          <div style=\"display: flex\">\r\n            <div style=\"font-size: 25px; font-weight: 500\">\r\n              <i class=\"el-icon-chat-line-round\" style=\"color: #4facfe\"></i>&nbsp;&nbsp;评论\r\n            </div>\r\n            <div style=\"margin-left: 650px;margin-top: 20px;font-size: 18px;\">\r\n              {{comment_num}} 条评论 <div class=\"el-icon-chat-line-round\"></div>\r\n              | {{like_num}} 人点赞\r\n              <div v-if=\"is_like==false\" @click=\"like\" style=\"color: red\" class=\"glyphicon glyphicon-heart-empty\"></div>\r\n              <div v-else @click=\"nolike\" style=\"color: red\" class=\"glyphicon glyphicon-heart\"></div>\r\n            </div>\r\n          </div>\r\n          <!-- 评论的展示 -->\r\n          <div style=\"margin-left: 5vh; margin-right: 10vh\">\r\n            <!--头像 昵称 回复 删除-->\r\n            <div\r\n              v-for=\"(comment, index) in comment\"\r\n              :key=\"index\"\r\n              style=\"border-bottom: #d9d9d9 solid 1px;margin-top:10px;\"\r\n            >\r\n              <div style=\"display: flex\">\r\n                <el-avatar :size=\"45\" :src=\"comment.user.avatar\"></el-avatar>\r\n                <span class=\"comment-username\">{{\r\n                  comment.user.nickname\r\n                }}</span>\r\n                <!-- 只有评论的人和视频的作者可以删除评论-->\r\n                <span\r\n                  style=\"\r\n                    color: red;\r\n                    padding-top: 15px;\r\n                    margin-left: 10px;\r\n                    font-size: 10px;\r\n                  \"\r\n                  @click=\"deletecommentone(comment)\"\r\n                  >删除</span\r\n                >\r\n              </div>\r\n              <div class=\"comment-content\">{{ comment.content }}</div>\r\n              <!-- 对评论的回复 -->\r\n              <div\r\n                v-for=\"(recomment, item) in comment.recomment\"\r\n                :key=\"item\"\r\n                style=\"\r\n                  margin-left: 10vh;\r\n                  margin-top: 2vh;\r\n                  border-top: #d9d9d9 solid 1px;\r\n                \"\r\n              >\r\n                <!-- 评论回复的内容 -->\r\n                <div style=\"display: flex; margin-top: 1vh\">\r\n                  <el-avatar\r\n                    :size=\"45\"\r\n                    :src=\"recomment.replyUser.avatar\"\r\n                  ></el-avatar>\r\n                  <span class=\"comment-username\">{{\r\n                    recomment.replyUser.nickname\r\n                  }}</span>\r\n                  <span\r\n                    style=\"\r\n                      color: red;\r\n                      padding-top: 15px;\r\n                      margin-left: 10px;\r\n                      font-size: 10px;\r\n                    \"\r\n                    @click=\"deletecomment(recomment)\"\r\n                    >删除</span\r\n                  >\r\n                </div>\r\n                <div class=\"comment-content recomment\">\r\n                  {{ recomment.content }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--  -->\r\n        </el-card>\r\n\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  mounted() {\r\n    //获取文章内容和评论信息\r\n    this.articledetail(this.$route.query.id);\r\n    this.commentone(this.$route.query.id);\r\n    this.commentandlike(this.$route.query.id);\r\n  },\r\n  data() {\r\n    return {\r\n      is_like:false,//当前用户是否给这篇文章点过赞\r\n      comment_num:0,\r\n      like_num:0,\r\n\r\n      // 文章详情\r\n      myBlog: {\r\n        id: 0,\r\n        content: \"\",\r\n        title: \"\",\r\n        author:\"\",\r\n      },\r\n      //当前输入的一级评论内容\r\n      ruleForm: {\r\n        content: \"\",\r\n      },\r\n      //当前输入的二级评论内容\r\n      form1: {\r\n        desc: \"\",\r\n      },\r\n      //评论表单验证规则\r\n      rules: {\r\n        content: [\r\n          { required: true, message: \"留下你的评论吧！\", trigger: \"blur\" },\r\n        ],\r\n      },\r\n    //存放所有评论内容\r\n      comment: [\r\n        {\r\n          imgurl: \"\",\r\n          username: \"\",\r\n          content: \"\",\r\n          recomment: [\r\n            {\r\n              imgurl:\"\",\r\n              username: \"\",\r\n              content: \"\",\r\n            },\r\n          ],\r\n        }\r\n      ],\r\n      //   回复评论\r\n      dialogFormVisible: false,\r\n      dialogFormVisible1: false,\r\n    };\r\n  },\r\n  methods: {\r\n    onInput(event) {\r\n      console.log(event);\r\n      this.ruleForm.content = event.data;\r\n    },\r\n    //\r\n    onInput1(event) {\r\n      console.log(event);\r\n      this.form1.desc = event.data;\r\n    },\r\n    goBack() {\r\n      this.$router.go(-1);\r\n    },\r\n    // 评论和点赞\r\n    async commentandlike(id) {\r\n      const result = await this.$http.get(`/article/commentandlike?id=${id}`,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n        }\r\n      });\r\n      const result1 = await this.$http.get(`/al/islike?aid=${id}&uid=${JSON.parse(localStorage.getItem(\"userdata\")).id}`,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n        }\r\n      });\r\n      if (result&&result1) {\r\n        this.comment_num=result.data.obj.comment_num;\r\n        this.like_num=result.data.obj.like_num;\r\n        this.is_like=result1.data;\r\n        this.$message.success(\"获取评论和点赞数据成功！\");\r\n      }else{\r\n        this.$message.error(\"获取评论和点赞数据失败！\");\r\n      }\r\n    },\r\n    async like() {\r\n      this.$http.get(`/al/add?aid=${this.$route.query.id}&uid=${JSON.parse(localStorage.getItem(\"userdata\")).id}`,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n        }\r\n      }).then(resp=>{\r\n        if (resp) {\r\n          let res = resp.data;\r\n          if (res.code === 200) {\r\n            this.is_like=true;\r\n            this.commentandlike(this.$route.query.id);\r\n            this.$message.success(res.message);\r\n          } else {\r\n            this.$message.error(res.message);\r\n          }\r\n        } else {\r\n          this.$message.error(resp.data.message);\r\n        }\r\n      });\r\n    },\r\n    async nolike() {\r\n      this.$http.get(`/al/delete?aid=${this.$route.query.id}&uid=${JSON.parse(localStorage.getItem(\"userdata\")).id}`,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n        }\r\n      }).then(resp=>{\r\n        if (resp) {\r\n          let res = resp.data;\r\n          if (res.code === 200) {\r\n            this.is_like=false;\r\n            this.commentandlike(this.$route.query.id);\r\n            this.$message.success(res.message);\r\n          } else {\r\n            this.$message.error(res.message);\r\n          }\r\n        } else {\r\n          this.$message.error(resp.data.message);\r\n        }\r\n      });\r\n    },\r\n    // 显示文章详情\r\n    async articledetail(id) {\r\n      const result = await this.$http.get(`/article/show?id=${id}`,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n        }\r\n      });\r\n      if (result) {\r\n        this.myBlog = result.data.obj;\r\n        const result1 = await this.$http.get(`/user/finduser?id=${this.myBlog.uid}`,{\r\n          headers: {\r\n            Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n          }\r\n        });\r\n        this.myBlog.author=result1.data.obj.username;\r\n      } else {\r\n        this.$message.error(\"获取文章数据失败！\");\r\n      }\r\n    },\r\n    // 获取一级评论\r\n    async commentone(id) {\r\n      const result = await this.$http.get(`/ac/list1?aid=${id}`,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n        }\r\n      });\r\n      // console.log(result);\r\n      this.comment = result.data;\r\n      for (var i = 0; i < this.comment.length; i++) {\r\n        //对于每个一级评论，获取他的二级评论\r\n        const res = await this.commenttwo(this.comment[i].id);\r\n        this.comment[i].recomment = res;\r\n      }\r\n      // 强制更新数据\r\n      this.$forceUpdate();\r\n    },\r\n    //获取二级评论\r\n    async commenttwo(id) {\r\n      const result = await this.$http.get(`/ac/list2?cid=${id}`,{\r\n        headers: {\r\n          Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n        }\r\n      });\r\n      return result.data;\r\n    },\r\n    //提交评论\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate(async (valid) => {\r\n        if (valid) {\r\n          const articleComment = {\r\n            aid: this.$route.query.id,//文章的id\r\n            uid: JSON.parse(localStorage.getItem(\"userdata\")).id,//文章作者的id\r\n            content: this.ruleForm.content,//内容\r\n            pid: 0,\r\n            reply_uid: 0,//是哪个评论的二级评论\r\n          };\r\n          //添加\r\n          const result = await this.$http.post(\"/ac/addAc\", articleComment,{\r\n            headers: {\r\n              Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n            }\r\n          });\r\n          this.$message.success(result.data.message);\r\n          this.commentone(this.$route.query.id);\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 对一级评论的弹出框\r\n    replycommentone(comment) {\r\n      this.dialogFormVisible = true;\r\n      this.form1.comment = comment;\r\n    },\r\n    // 对评论的回复\r\n    submitForm1(formName) {\r\n      this.$refs[formName].validate(async (valid) => {\r\n        if (valid) {\r\n          console.log(this.form1);\r\n          const articleComment = {\r\n            pid: this.form1.comment.id,\r\n            replyUid: JSON.parse(localStorage.getItem(\"userdata\")).id,\r\n            uid: this.form1.comment.user.id,\r\n            content: this.form1.desc,\r\n            aid: Number(this.$route.query.id),\r\n          };\r\n          const result = await this.$http.post(\"/ac/addAc\", articleComment,{\r\n            headers: {\r\n              Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n            }\r\n          });\r\n          this.dialogFormVisible = false;\r\n          this.$message.success(result.data.message);\r\n          this.commentone(this.$route.query.id);\r\n          this.ruleForm.content = \"\";\r\n          this.form1.desc = \"\";\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 对二级评论的弹出框\r\n    replycommenttwo(comment) {\r\n      this.dialogFormVisible1 = true;\r\n      this.form1.comment = comment;\r\n    },\r\n    // 对回复的回复\r\n    submitForm2(formName) {\r\n      this.$refs[formName].validate(async (valid) => {\r\n        if (valid) {\r\n          console.log(this.form1);\r\n          const articleComment = {\r\n            pid: this.form1.comment.id,\r\n            replyUid: JSON.parse(localStorage.getItem(\"userdata\")).id,\r\n            uid: this.form1.comment.user.id,\r\n            content: this.form1.desc,\r\n            aid: Number(this.$route.query.id),\r\n          };\r\n          const result = await this.$http.post(\"/ac/addAc\", articleComment,{\r\n            headers: {\r\n              Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n            }\r\n          });\r\n          this.dialogFormVisible1 = false;\r\n          this.$message.success(result.data.message);\r\n          this.commentone(this.$route.query.id);\r\n          this.ruleForm.content = \"\";\r\n          this.form1.desc = \"\";\r\n        } else {\r\n          console.log(\"error submit!!\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    // 删除一级评论\r\n    yicontent(comment) {\r\n      this.$confirm(\"此操作将永久删除, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      })\r\n      .then(async () => {\r\n        console.log(comment.id);\r\n        const result = await this.$http.delete(\r\n                \"/ac/delete1?cid=\" + comment.id,{\r\n                  headers: {\r\n                    Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n                  }\r\n                }\r\n        );\r\n        //删除成功\r\n        if (result.data.code == 200) {\r\n          this.$message.success(result.data.message);\r\n          this.commentone(this.$route.query.id);\r\n        } else {\r\n          this.$message.error(result.data.message);\r\n        }\r\n      })\r\n    },\r\n    // 删除二级评论\r\n    ercontent(comment) {\r\n      this.$confirm(\"此操作将永久删除, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      })\r\n      .then(async () => {\r\n        console.log(comment);\r\n        const result = await this.$http.delete(\r\n                \"/ac/delete?cid=\" + comment.id,{\r\n                  headers: {\r\n                    Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n                  }\r\n                }\r\n        );\r\n        //删除成功\r\n        if (result.data.code == 200) {\r\n          this.$message.success(result.data.message);\r\n          this.commentone(this.$route.query.id);\r\n        } else {\r\n          this.$message.error(result.data.message);\r\n        }\r\n      })\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\nimage {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n// 评论的样式\r\n.comment-username {\r\n  font-size: 20px;\r\n  height: 30px;\r\n  line-height: 30px;\r\n  padding-top: 10px;\r\n  margin-left: 2vh;\r\n}\r\n.replay {\r\n  margin-left: 20px;\r\n  padding-top: 10px;\r\n  color: red;\r\n}\r\n.comment-content {\r\n  margin-left: 8vh;\r\n  font-size: 18px;\r\n}\r\n.recomment {\r\n  margin-top: 5px;\r\n  color: #4c4948;\r\n}\r\n</style>\r\n"]}]}