{"remainingRequest":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\src\\components\\editdetail.vue?vue&type=style&index=0&id=cb66812a&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\src\\components\\editdetail.vue","mtime":1670068650745},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\css-loader\\dist\\cjs.js","mtime":1666323413935},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1666323416977},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\postcss-loader\\src\\index.js","mtime":1666323415315},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\less-loader\\dist\\cjs.js","mtime":1666323414827},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666323412932},{"path":"C:\\Users\\Lenovo\\Desktop\\blog\\blogadmin\\node_modules\\vue-loader\\lib\\index.js","mtime":1666323415965}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouYm94X2NhcmQgew0KICB3aWR0aDogNTUwcHg7DQp9DQoNCi5wc2RGb3JtIHsNCiAgcGFkZGluZy1yaWdodDogMzBweDsNCn0NCg0KLnJlc2V0QnRuIHsNCiAgbWFyZ2luLWxlZnQ6IDMwcHg7DQp9DQouYnRuMSB7DQogIHdpZHRoOiAxNTBweDsNCn0NCi5hdmF0YXItdXBsb2FkZXIgLmVsLXVwbG9hZCB7DQogIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5Ow0KICBib3JkZXItcmFkaXVzOiAxMDBweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQogIG92ZXJmbG93OiBoaWRkZW47DQp9DQovLyAuYXZhdGFyLXVwbG9hZGVyIC5lbC11cGxvYWQ6aG92ZXIgew0KLy8gLy8gICBib3JkZXItY29sb3I6ICM0MDllZmY7DQovLyB9DQouYXZhdGFyLXVwbG9hZGVyLWljb24gew0KICBmb250LXNpemU6IDI4cHg7DQogIGNvbG9yOiAjOGM5MzlkOw0KICB3aWR0aDogMTc4cHg7DQogIGhlaWdodDogMTc4cHg7DQogIGxpbmUtaGVpZ2h0OiAxNzhweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KLmF2YXRhciB7DQogIHdpZHRoOiAxNzhweDsNCiAgaGVpZ2h0OiAxNzhweDsNCiAgZGlzcGxheTogYmxvY2s7DQogIGJvcmRlci1yYWRpdXM6IDEwMHB4Ow0KfQ0KLy/miorkuIrkvKDmlofku7bnmoTlh6DkuKrlrZfpmpDol4/mjokNCi5lbC11cGxvYWQtLXRleHQgaW5wdXR7DQogIGRpc3BsYXk6IG5vbmU7DQp9DQo="},{"version":3,"sources":["editdetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4KA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editdetail.vue","sourceRoot":"src/components","sourcesContent":["<!--修改个人信息-->\r\n<template>\r\n  <div>\r\n    <el-card class=\"box_card\">\r\n      <div slot=\"header\" class=\"clearfix\" style=\"text-align:left;\">\r\n        <span>修改个人资料</span>\r\n      </div>\r\n      <el-upload\r\n        class=\"avatar-uploader\"\r\n        :action=\"doupload()\"\r\n        :show-file-list=\"false\"\r\n        :on-success=\"handleAvatarSuccess\"\r\n        :before-upload=\"beforeAvatarUpload\"\r\n        style=\"display: inline-block; width: 200px; margin-left: 0px\"\r\n      >\r\n        <!-- 上传成功后展示的图片 -->\r\n        <img v-if=\"loginForm.avatar\" :src=\"loginForm.avatar\" class=\"avatar\" />\r\n        <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n      </el-upload>\r\n      <!-- 表单 -->\r\n      <el-form\r\n        class=\"login_form\"\r\n        :model=\"loginForm\"\r\n        :rules=\"loginFormRules\"\r\n        ref=\"loginFormRef\"\r\n        style=\"width: 400px\"\r\n      >\r\n        <p style=\"text-align: left\">账号</p>\r\n        <el-form-item prop=\"username\">\r\n          <el-input\r\n                  prefix-icon=\"iconfont icon-BasicIcons-all-\"\r\n                  placeholder=\"请输入账号\"\r\n                  v-model=\"loginForm.username\"\r\n                  disabled\r\n          ></el-input>\r\n        </el-form-item>\r\n        <p style=\"text-align: left\">用户名</p>\r\n        <el-form-item prop=\"nickname\">\r\n          <el-input\r\n                  prefix-icon=\"iconfont icon-BasicIcons-all-\"\r\n                  placeholder=\"请输入用户名\"\r\n                  v-model=\"loginForm.nickname\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <p style=\"text-align: left\">手机号</p>\r\n        <el-form-item prop=\"phone\">\r\n          <el-input\r\n                  prefix-icon=\"el-icon-phone-outline\"\r\n                  placeholder=\"请输入手机号\"\r\n                  v-model=\"loginForm.phone\"\r\n          ></el-input>\r\n        </el-form-item>\r\n        <el-form-item class=\"form_button\">\r\n          <el-button type=\"primary\" round class=\"btn1\" @click=\"submit()\">提交<i class=\"el-icon-right\"></i></el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nexport default {\r\n  mounted(){\r\n    this.loginForm = JSON.parse(localStorage.getItem('userdata'))\r\n  },\r\n  data() {\r\n    return {\r\n      imageUrl:\r\n        \"https://img1.baidu.com/it/u=2820222784,2850106904&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1665075600&t=57bf9c1de8fcdd94ce92c892682a1fe3\",\r\n      loginForm: {\r\n        username: \"\",\r\n        nickname:\"\",\r\n        phone: \"\",\r\n        avatar:\"\"\r\n      },\r\n      loginFormRules: {\r\n        username: [\r\n          { required: true, message: \"请输入账号\", trigger: \"blur\" },\r\n          // { message: '长度最多不超过 12 个字符', trigger: 'blur' }\r\n        ],\r\n        nickname: [\r\n          { required: true, message: \"请输入用户名\", trigger: \"blur\" },\r\n        ],\r\n        phone: [\r\n          { required: true, message: \"请重新输入手机号码\", trigger: \"blur\" },\r\n          {\r\n            pattern:\r\n              /^((13[0-9])|(14[0-9])|(15[0-9])|(17[0-9])|(18[0-9])|(19[0-9]))\\d{8}$/,\r\n            message: \"请输入有效的手机号码\",\r\n          },\r\n          // { max: 10, message: '长度最多不超过 10 个字符', trigger: 'blur' }\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    submit() {\r\n      this.$refs.loginFormRef.validate(async (valid) => {\r\n        if (!valid) return this.$message.error(\"表单验证失败！\");\r\n        console.log(this.loginForm);\r\n        var user = this.loginForm;\r\n        console.log(user);\r\n        const result = await this.$http.put(\r\n          \"/user/infoModify\",\r\n          this.loginForm,{\r\n                  headers: {\r\n                    Authorization: \"Bearer \" + JSON.parse(localStorage.getItem('userdata')).token\r\n                  }\r\n                }\r\n        );\r\n        console.log(\"login\", result);\r\n        if (result.data.code === 200) {\r\n          this.$message.success(\"修改成功\");\r\n          localStorage.setItem(\"userdata\", JSON.stringify(result.data.obj));\r\n          console.log(\r\n            \"localstorage\",\r\n            JSON.parse(localStorage.getItem(\"userdata\"))\r\n          );\r\n        } else {\r\n          this.$message.error(result.data.message);\r\n          // location.reload();\r\n        }\r\n        // const res = await this.$http.get('login', { params: this.loginForm })\r\n      });\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields();\r\n    },\r\n    // 封装上传文件请求\r\n    doupload() {\r\n      return axios.defaults.baseURL + \"/file/upload\";\r\n    },\r\n    // 成功上传之后的回调函数\r\n    handleAvatarSuccess(res,) {\r\n      this.loginForm.avatar = res.obj\r\n      console.log(res);\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      // const isJPG = file.type == \"image/png\";\r\n      const isLt2M = file.size / 1024 / 1024 < 5;\r\n      console.log(file);\r\n      // 实例化一个阅读器对象\r\n      var reader = new FileReader();\r\n      // 读取文件的路径，没有返回值,结果在reader.result里\r\n      reader.readAsDataURL(file);\r\n      // 读取需要时间，读完后再修改图片路径\r\n      var that = this;\r\n      reader.onload = function () {\r\n        //回显给上方图片中\r\n        that.loginForm.avatar = this.result;\r\n      };\r\n      if (\r\n        file.type == \"image/png\" ||\r\n        file.type == \"image/jpg\" ||\r\n        file.type == \"image/jpeg\" ||\r\n        file.type == \"image/JPG\"\r\n      ) {\r\n        // this.$message.error(\"上传头像图片格式不正确\");\r\n      } else {\r\n        this.$message.error(\"上传头像图片格式不正确\");\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传头像图片大小不能超过 5MB!\");\r\n      }\r\n      return isLt2M;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.box_card {\r\n  width: 550px;\r\n}\r\n\r\n.psdForm {\r\n  padding-right: 30px;\r\n}\r\n\r\n.resetBtn {\r\n  margin-left: 30px;\r\n}\r\n.btn1 {\r\n  width: 150px;\r\n}\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 100px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n// .avatar-uploader .el-upload:hover {\r\n// //   border-color: #409eff;\r\n// }\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n  border-radius: 100px;\r\n}\r\n//把上传文件的几个字隐藏掉\r\n.el-upload--text input{\r\n  display: none;\r\n}\r\n</style>\r\n"]}]}